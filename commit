fixed most 
more robust control on the file structure
robust closing the app (alt+f4)
